// Code generated by musgen-go. DO NOT EDIT.

package cmds

import (
	"fmt"
	"reflect"

	"github.com/cmd-stream/core-go"
	dts "github.com/mus-format/dts-stream-go"
	exts "github.com/mus-format/ext-mus-stream-go"
	muss "github.com/mus-format/mus-stream-go"
	"github.com/mus-format/mus-stream-go/ord"
	"github.com/mus-format/mus-stream-go/varint"
	"github.com/ymz-ncnk/go-client-server-communication-benchmarks/projects/cmd-stream/tcp_mus/receiver"
)

var EchoCmdMUS = echoCmdMUS{}

type echoCmdMUS struct{}

func (s echoCmdMUS) Marshal(v EchoCmd, w muss.Writer) (n int, err error) {
	n, err = ord.Bool.Marshal(v.Bool, w)
	if err != nil {
		return
	}
	var n1 int
	n1, err = varint.Int64.Marshal(v.Int64, w)
	n += n1
	if err != nil {
		return
	}
	n1, err = ord.String.Marshal(v.String, w)
	n += n1
	if err != nil {
		return
	}
	n1, err = varint.Float64.Marshal(v.Float64, w)
	n += n1
	return
}

func (s echoCmdMUS) Unmarshal(r muss.Reader) (v EchoCmd, n int, err error) {
	v.Bool, n, err = ord.Bool.Unmarshal(r)
	if err != nil {
		return
	}
	var n1 int
	v.Int64, n1, err = varint.Int64.Unmarshal(r)
	n += n1
	if err != nil {
		return
	}
	v.String, n1, err = ord.String.Unmarshal(r)
	n += n1
	if err != nil {
		return
	}
	v.Float64, n1, err = varint.Float64.Unmarshal(r)
	n += n1
	return
}

func (s echoCmdMUS) Size(v EchoCmd) (size int) {
	size = ord.Bool.Size(v.Bool)
	size += varint.Int64.Size(v.Int64)
	size += ord.String.Size(v.String)
	return size + varint.Float64.Size(v.Float64)
}

func (s echoCmdMUS) Skip(r muss.Reader) (n int, err error) {
	n, err = ord.Bool.Skip(r)
	if err != nil {
		return
	}
	var n1 int
	n1, err = varint.Int64.Skip(r)
	n += n1
	if err != nil {
		return
	}
	n1, err = ord.String.Skip(r)
	n += n1
	if err != nil {
		return
	}
	n1, err = varint.Float64.Skip(r)
	n += n1
	return
}

var EchoCmdDTS = dts.New[EchoCmd](EchoCmdDTM, EchoCmdMUS)

var CmdMUS = cmdMUS{}

type cmdMUS struct{}

func (s cmdMUS) Marshal(v core.Cmd[receiver.Receiver], w muss.Writer) (n int, err error) {
	if m, ok := v.(exts.MarshallerTypedMUS); ok {
		return m.MarshalTypedMUS(w)
	}
	panic(fmt.Sprintf("%v doesn't implement the exts.MarshallerTypedMUS interface", reflect.TypeOf(v)))
}

func (s cmdMUS) Unmarshal(r muss.Reader) (v core.Cmd[receiver.Receiver], n int, err error) {
	dtm, n, err := dts.DTMSer.Unmarshal(r)
	if err != nil {
		return
	}
	var n1 int
	switch dtm {
	case EchoCmdDTM:
		v, n1, err = EchoCmdDTS.UnmarshalData(r)
	default:
		err = fmt.Errorf("unexpected %v DTM", dtm)
		return
	}
	n += n1
	return
}

func (s cmdMUS) Size(v core.Cmd[receiver.Receiver]) (size int) {
	if m, ok := v.(exts.MarshallerTypedMUS); ok {
		return m.SizeTypedMUS()
	}
	panic(fmt.Sprintf("%v doesn't implement the exts.MarshallerTypedMUS interface", reflect.TypeOf(v)))
}

func (s cmdMUS) Skip(r muss.Reader) (n int, err error) {
	dtm, n, err := dts.DTMSer.Unmarshal(r)
	if err != nil {
		return
	}
	var n1 int
	switch dtm {
	case EchoCmdDTM:
		n1, err = EchoCmdDTS.SkipData(r)
	default:
		err = fmt.Errorf("unexpected %v DTM", dtm)
		return
	}
	n += n1
	return
}
